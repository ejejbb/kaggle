# 1. ìºê¸€ í•„ì‚¬: House Price Prediction

## ëŒ€íšŒ ì†Œê°œ
> ğŸ¡ ì•„ì´ì˜¤ì™€ì£¼ Amesì˜ ì£¼íƒ ë°ì´í„°ë¥¼ ê¸°ë°˜ìœ¼ë¡œ ì£¼íƒ íŒë§¤ ê°€ê²©(SalePrice)ì„ ì˜ˆì¸¡í•˜ëŠ” íšŒê·€ ë¬¸ì œ

* ì»¬ëŸ¼ ì„¤ëª… (ì´ 79ê°œì˜ ì„¤ëª… ë³€ìˆ˜ í¬í•¨)
```
Id: ê° í–‰ì„ êµ¬ë¶„í•˜ëŠ” ê³ ìœ  ID  
SalePrice: ì£¼íƒ íŒë§¤ ê°€ê²© (Target)  
LotArea: ë¶€ì§€ ë©´ì   
OverallQual: ì „ë°˜ì ì¸ ìì¬ ë° ë§ˆê° í’ˆì§ˆ  
YearBuilt: ì£¼íƒì´ ê±´ì¶•ëœ ì—°ë„  
GrLivArea: ì§€ìƒ ìƒí™œ ê³µê°„ ë©´ì   
GarageCars: ì°¨ê³  ìˆ˜ìš© ì°¨ëŸ‰ ìˆ˜  
... (ë‹¤ì–‘í•œ êµ¬ì¡°ì , ìœ„ì¹˜ì , í’ˆì§ˆ ê´€ë ¨ ë³€ìˆ˜ í¬í•¨)
```

* ğŸ“Š í‰ê°€ ì§€í‘œ: RMSE
```
í‰ê°€ ì‹œ ì˜ˆì¸¡ê°’ê³¼ ì‹¤ì œê°’ì˜ **ë¡œê·¸ ê°’ ì°¨ì´**ë¥¼ ê¸°ë°˜ìœ¼ë¡œ RMSE ê³„ì‚°
â†’ ê³ ê°€/ì €ê°€ ì£¼íƒ ëª¨ë‘ ë™ì¼í•œ ë¹„ì¤‘ìœ¼ë¡œ ì˜¤ì°¨ ì¸¡ì •
```

* ğŸ” ì°¸ê°€ìë“¤ì´ ì‚¬ìš©í•˜ëŠ” ì£¼ìš” ê¸°ìˆ ë“¤
```
í”¼ì²˜ ì—”ì§€ë‹ˆì–´ë§: ë²”ì£¼í˜• ë³€ìˆ˜ ì²˜ë¦¬, ê²°ì¸¡ê°’ ì²˜ë¦¬, ë³€ìˆ˜ ë³€í™˜(ë¡œê·¸, Box-Cox ë“±)

íšŒê·€ ëª¨ë¸ë§:  
  - ì„ í˜• íšŒê·€ (Linear, Ridge, Lasso, ElasticNet)  
  - íŠ¸ë¦¬ ê¸°ë°˜ ëª¨ë¸ (Random Forest, Gradient Boosting, XGBoost, LightGBM)  
  - ì•™ìƒë¸”(Stacking, Blending, Voting ë“±)  
EDA: ë³€ìˆ˜ ê°„ ìƒê´€ê´€ê³„ ë¶„ì„, ë¶„í¬ ì‹œê°í™”, ì´ìƒì¹˜ íƒì§€ ë“±  
```

### ë°ì´í„° ë¶ˆëŸ¬ì˜¤ê¸°
```python
house_df = pd.concat([train,X_test],ignore_index = True, sort = False) # trainê³¼ test ë°ì´í„°ë¥¼ í•©ì¹¨
tr_idx = house_df['SalePrice'].notnull()
```

### ìœ ìš©í•œ í•¨ìˆ˜ ì •ì˜
> PCA

```python
def apply_pca(X, standardize=True):
    # Standardize - pcaëŠ” ìŠ¤ì¼€ì¼ì˜ ì˜í–¥ì„ ë§ì´ ë°›ìœ¼ë¯€ë¡œ
    if standardize:
        X = (X - X.mean(axis=0)) / X.std(axis=0)
    # Create principal components
    pca = PCA()
    X_pca = pca.fit_transform(X)
    # Convert to dataframe - ê° ì£¼ì„±ë¶„ì— ì´ë¦„ ë¶€ì—¬ í›„ dataframeìœ¼ë¡œ ë³€í™˜
    component_names = [f"PC{i+1}" for i in range(X_pca.shape[1])]
    X_pca = pd.DataFrame(X_pca, columns=component_names)
    # Create loadings - ê° ì£¼ì„±ë¶„ì˜ í”¼ì³ë³„ ê¸°ì—¬ë„(ë¡œë”©) í–‰ë ¬
    loadings = pd.DataFrame(
        pca.components_.T,  # transpose the matrix of loadings
        columns=component_names,  # so the columns are the principal components
        index=X.columns,  # and the rows are the original features
    )
    return pca, X_pca, loadings
```

### ê²°ì¸¡ì¹˜ ë³´ê°„
> ìˆ˜ì¹˜í˜• - KNN ì‚¬ìš©

KNN ImputerëŠ” ê²°ì¸¡ì¹˜ê°€ ìˆëŠ” í–‰ì„ ë¹„ìŠ·í•œ ë‹¤ë¥¸ í–‰ë“¤ì˜ ê°’ í‰ê· ìœ¼ë¡œ ì±„ìš°ëŠ” ë°©ì‹
```
ê° ìƒ˜í”Œ(í–‰)ì˜ ê²°ì¸¡ê°’ì€ ê°€ì¥ ê°€ê¹Œìš´ ì´ì›ƒ nê°œì˜ í‰ê· ê°’ì„ ì‚¬ìš©í•´ì„œ ì±„ì›Œì§„ë‹¤.

ë‘ ìƒ˜í”Œì´ "ê°€ê¹ë‹¤"ê³  íŒë‹¨ë˜ëŠ” ê¸°ì¤€ì€, ì„œë¡œ ê³µí†µì ìœ¼ë¡œ ê²°ì¸¡ì¹˜ê°€ ì—†ëŠ” í”¼ì²˜ë“¤ì˜ ê°’ì´ ë¹„ìŠ·í•  ê²½ìš°ë‹¤.

ì¦‰, ì‚¬ìš© ê°€ëŠ¥í•œ ê°’ë§Œì„ ê¸°ì¤€ìœ¼ë¡œ ê±°ë¦¬(ìœ ì‚¬ë„)ë¥¼ ì¸¡ì •í•˜ê³ , ê·¸ ê¸°ë°˜ìœ¼ë¡œ ì´ì›ƒì„ ê²°ì •í•´ í‰ê· ì„ ë‚´ëŠ” ë°©ì‹ì´ë‹¤.
```

íšŒê·€ ë¬¸ì œì—ì„œëŠ” ê°’ë“¤ì´ ì—°ì†ì ì´ë¯€ë¡œ, ë‹¨ìˆœí•œ í‰ê· ì´ë‚˜ ì¤‘ì•™ê°’ë³´ë‹¤ KNNì„ ì´ìš©í•œ ìœ ì‚¬ë„ ê¸°ë°˜ í‰ê· ì´ ë” ìì—°ìŠ¤ëŸ½ê³  ì„±ëŠ¥ì´ ë†’ì„ ìˆ˜ ìˆë‹¤.

### íƒ€ê¹ƒ ë³€ìˆ˜ì˜ ì‹œê°í™”
![alt text](/kaggle_study/image/image37.png)

ë¡œê·¸ ë³€í™˜ í›„,   
![alt text](/kaggle_study/image/image38.png)

ë¡œê·¸ í•¨ìˆ˜ëŠ” ì‘ì€ ìˆ«ì ê°„ì˜ ê°„ê²©ì€ ë„“íˆê³ , í° ìˆ«ì ê°„ì˜ ê°„ê²©ì€ ì¤„ì—¬ì£¼ëŠ” ì„±ì§ˆì´ ìˆìŒ.

### prophetì„ ì´ìš©í•´ íƒ€ê¹ƒ ë³€ìˆ˜ ì˜ˆì¸¡í•˜ê¸°
1. Prophet   
: Meta(êµ¬ í˜ì´ìŠ¤ë¶)ì—ì„œ ë§Œë“  ì‹œê³„ì—´ ë°ì´í„° ì˜ˆì¸¡ ë¼ì´ë¸ŒëŸ¬ë¦¬ë¡œ, íŠ¸ë Œë“œÂ·ê³„ì ˆì„±Â·íœ´ì¼ íš¨ê³¼ ë“±ì„ ìë™ìœ¼ë¡œ ê°ì§€í•´ì£¼ëŠ” ëª¨ë¸   

2. *YearBuilt*ì™€ *YearRemodAdd*ë¥¼ ì‚¬ìš©
> ìµœê·¼ì¼ìˆ˜ë¡, ìµœê·¼ì— ë¦¬ëª¨ë¸ë§ì„ í–ˆì„ìˆ˜ë¡ ê°’ì´ ë†’ì•„ì§

![alt text](/kaggle_study/image/image39.png)

![alt text](/kaggle_study/image/image40.png)

### ì´ìƒì¹˜ í™•ì¸ ë° ì œê±°
```python
sns.set(font_scale = 1.5)
sns.set_style("white")
sns.set_palette("Blues_r")
plt.figure(figsize=(16,5))
plt.subplot(1,2,1)
plt.subplots_adjust(wspace=0.3)
ax1 = sns.regplot(data=house_df, x='GrLivArea',y='SalePrice')
ax1.set_title('Outliers in GrLivArea',fontsize=20)
plt.axhline(y=250000, color='Green', linestyle='--', linewidth=3)
plt.axvline(x=4000, color='Green', linestyle='--', linewidth=3)
plt.text(4500, 150000, 'Outliers',color='red')
plt.subplot(1,2,2)
ax2 = sns.regplot(data=house_df, x='TotalBsmtSF',y='SalePrice')
ax2.set_title('Outliers in TotalBsmtSF',fontsize=20)
plt.axhline(y=250000, color='Green', linestyle='--', linewidth=3)
plt.axvline(x=4500, color='Green', linestyle='--', linewidth=3)
plt.text(5000, 200000, 'Outliers',color='red')
sns.despine()
```

ì´ìƒì¹˜ íŒë³„ ê¸°ì¤€ì„ í†µê³„ì ìœ¼ë¡œ ì •í•œ ê²ƒì´ ì•„ë‹ˆë¼ `ë„ë©”ì¸ ì§€ì‹ + ì‹œê°ì  íŒë‹¨`ìœ¼ë¡œ ê²°ì •í•œ ê²ƒ.

ex. ì¼ë°˜ì ì¸ ì£¼íƒ ë©´ì (GrLivArea)ì€ ëŒ€ëµ 1500~2500 sq.ft ì •ë„ì´ë¯€ë¡œ 4000 sq.ftëŠ” ë¯¸êµ­ í‰ê·  ê°€ì •ì˜ 2ë°° ì´ìƒì¸ ê²ƒì´ë¯€ë¡œ ì´ìƒì¹˜ë¡œ íŒë‹¨.