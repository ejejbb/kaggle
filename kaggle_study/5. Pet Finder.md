# 1. ìºê¸€ í•„ì‚¬: PetFinder.my - Pawpularity Contest

## ğŸ¶ ëŒ€íšŒ ì†Œê°œ
> ìœ ê¸° ë™ë¬¼ ì…ì–‘ í”Œë«í¼ PetFinder.myì˜ ë°˜ë ¤ë™ë¬¼ í”„ë¡œí•„ ì´ë¯¸ì§€ë¥¼ ê¸°ë°˜ìœ¼ë¡œ **Pawpularity ì ìˆ˜(ì¸ê¸°ë„)** ë¥¼ ì˜ˆì¸¡í•˜ëŠ” íšŒê·€ ë¬¸ì œ

* PawpularityëŠ” ì‚¬ì§„ì˜ **ì›¹/ëª¨ë°”ì¼ í˜ì´ì§€ ì¡°íšŒ ìˆ˜**, í´ë¦­, ìŠ¤í¬ë¡¤ ë“±ì˜ ì‚¬ìš©ì ë°˜ì‘ì„ ê¸°ë°˜ìœ¼ë¡œ ê³„ì‚°ë˜ë©°, **ë‹¤ì–‘í•œ í™˜ê²½ ìš”ì¸ì„ ë³´ì •í•œ ì •ê·œí™”ëœ ì§€í‘œ**.

## ğŸ¾ ëŒ€íšŒ ëª©ì 
> **AI ê¸°ë°˜ ì¶”ì²œ ì‹œìŠ¤í…œ**ì„ êµ¬ì¶•í•´ ë³´í˜¸ì†Œ ì‚¬ì§„ì˜ **í’ˆì§ˆ ê°œì„ **ê³¼ **êµ¬ë„ ì¶”ì²œ**ì„ ì œê³µí•˜ê³ , ë” ë§ì€ ìœ ê¸°ë™ë¬¼ì´ ë¹ ë¥´ê²Œ ì…ì–‘ë  ìˆ˜ ìˆë„ë¡ ë•ëŠ” ê²ƒì„ ëª©í‘œë¡œ í•¨.

---

## ğŸ“ ë°ì´í„° êµ¬ì„±
> ì´ë¯¸ì§€ ë°ì´í„° + ìˆ˜ì‘ì—…ìœ¼ë¡œ ë¼ë²¨ë§ëœ ë©”íƒ€ë°ì´í„° ì œê³µ
```
ğŸ”¸ ì´ë¯¸ì§€ ë°ì´í„°

* `train/`: `{id}.jpg` í˜•ì‹ì˜ í›ˆë ¨ ì´ë¯¸ì§€ (ì•½ 9,900ê°œ)
* `test/`: í…ŒìŠ¤íŠ¸ ì´ë¯¸ì§€ (ì•½ 6,800ê°œ, í‰ê°€ ì‹œ ì‹¤ì œ ë°ì´í„°ë¡œ êµì²´ë¨)

ğŸ”¸ ë©”íƒ€ë°ì´í„° (CSV)

* `train.csv`: í›ˆë ¨ ì´ë¯¸ì§€ì— ëŒ€í•œ ë©”íƒ€ë°ì´í„° + ëª©í‘œê°’ `Pawpularity` í¬í•¨
* `test.csv`: í…ŒìŠ¤íŠ¸ ì´ë¯¸ì§€ìš© ë©”íƒ€ë°ì´í„°
* `sample_submission.csv`: ì œì¶œ ì˜ˆì‹œ íŒŒì¼ (Id, ì˜ˆì¸¡ Pawpularity í¬í•¨)
```
---

### ğŸ“Œ ì£¼ìš” ì»¬ëŸ¼ (train.csv / test.csv ê³µí†µ)

```
Id           : ì´ë¯¸ì§€ íŒŒì¼ëª…ê³¼ ë™ì¼í•œ ê³ ìœ  ID
Pawpularity  : (trainì—ë§Œ ìˆìŒ) ì˜ˆì¸¡ ëŒ€ìƒ ì¸ê¸°ë„ ì ìˆ˜ (0~100 ì‚¬ì´)
Focus        : ë°°ê²½ì´ ê¹”ë”í•˜ê³  í”¼ì‚¬ì²´(ë™ë¬¼)ê°€ ì˜ ë“œëŸ¬ë‚˜ëŠ”ì§€
Eyes         : ëˆˆì´ ì •ë©´ ë˜ëŠ” ê±°ì˜ ì •ë©´ì„ í–¥í•˜ê³  ëª…í™•í•œì§€
Face         : ì–¼êµ´ì´ ëª…í™•í•˜ê²Œ ë³´ì´ëŠ”ì§€
Near         : í•œ ë§ˆë¦¬ì˜ ë™ë¬¼ì´ ì‚¬ì§„ì˜ ì ˆë°˜ ì´ìƒì„ ì°¨ì§€í•˜ëŠ”ì§€
Action       : ë™ì‘ì´ ë‹´ê²¨ ìˆëŠ”ì§€ (ì˜ˆ: ì í”„)
Accessory    : ì¥ë‚œê°, ìŠ¤í‹°ì»¤ ë“± ì†Œí’ˆì´ ìˆëŠ”ì§€
Group        : ì—¬ëŸ¬ ë§ˆë¦¬ ë™ë¬¼ì´ í•¨ê»˜ ìˆëŠ”ì§€
Collage      : ì½œë¼ì£¼ ì´ë¯¸ì§€ì¸ì§€
Human        : ì‚¬ëŒì´ ì‚¬ì§„ì— ìˆëŠ”ì§€
Occlusion    : ì¥ì• ë¬¼(ìš°ë¦¬, ì† ë“±)ì´ ë™ë¬¼ì„ ê°€ë¦¬ëŠ”ì§€
Info         : í…ìŠ¤íŠ¸/ë¼ë²¨ì´ ì´ë¯¸ì§€ì— ìˆëŠ”ì§€
Blur         : íë¦¿í•˜ê±°ë‚˜ ë…¸ì´ì¦ˆê°€ ìˆëŠ”ì§€ (Eyesê°€ 0ìœ¼ë¡œ ê³ ì •ë¨)
```

---

## ğŸ“Š í‰ê°€ ì§€í‘œ: RMSE
>ì˜ˆì¸¡í•œ Pawpularity ì ìˆ˜ì™€ ì‹¤ì œ ì ìˆ˜ ê°„ì˜ ì œê³± ì˜¤ì°¨ í‰ê· ì˜ ì œê³±ê·¼
```
RMSE = sqrt(mean((y_pred - y_true)^2))

â†’ ê³ ë“ì ê³¼ ì €ë“ì  ëª¨ë‘ì— ë™ì¼í•œ ì¤‘ìš”ë„ë¥¼ ë¶€ì—¬í•¨
```

---

## ğŸ§  ì°¸ê°€ìë“¤ì´ ì‚¬ìš©í•˜ëŠ” ì£¼ìš” ê¸°ìˆ ë“¤

```
ğŸ” EDA:
- ë©”íƒ€ë°ì´í„°ì™€ Pawpularity ê°„ì˜ ìƒê´€ê´€ê³„ ì‹œê°í™”
- ì´ë¯¸ì§€ ë°ê¸°, ìƒ‰ìƒ, í•´ìƒë„ ë“± ì´ë¯¸ì§€ í†µê³„ê°’ ì¶”ì¶œ

ğŸ›  í”¼ì²˜ ì—”ì§€ë‹ˆì–´ë§:
- ë©”íƒ€ë°ì´í„° ê¸°ë°˜ ë³€ìˆ˜ ì„ íƒ / ì¡°í•©
- ì´ë¯¸ì§€ ê¸°ë°˜ ì¶”ê°€ í”¼ì²˜ ìƒì„± (CNN ì¤‘ê°„ ì¶œë ¥, ì´ë¯¸ì§€ í†µê³„)

ğŸ“· ë”¥ëŸ¬ë‹ ëª¨ë¸ë§:
- ì´ë¯¸ì§€ ì „ìš© ëª¨ë¸: fastai, timm, EfficientNet, Swin Transformer
- ì´ë¯¸ì§€ + ë©”íƒ€ë°ì´í„° í˜¼í•© ëª¨ë¸ (TabNet, MLP + CNN ë³‘ë ¬ êµ¬ì¡°)

ğŸ§ª ì•™ìƒë¸”:
- K-fold cross-validation
- ëª¨ë¸ ì•™ìƒë¸” / ë¸”ë Œë”©
```

---

### ë°ì´í„° ë¶ˆëŸ¬ì˜¤ê¸°
```python
from google.colab import files
files.upload()
## ë‹¤ìš´ë°›ì€ token íŒŒì¼ì„ ì—…ë¡œë“œ

# Kaggle API ì„¤ì¹˜ ë° ì„¤ì •
!pip install -q kaggle
!mkdir -p ~/.kaggle
!cp kaggle.json ~/.kaggle/
!chmod 600 ~/.kaggle/kaggle.json

# ëŒ€íšŒ ë°ì´í„° ë‹¤ìš´ë¡œë“œ
## ëŒ€íšŒ ì°¸ê°€í•´ì•¼ ë°ì´í„° ë‹¤ìš´ ê°€ëŠ¥
!kaggle competitions download -c petfinder-pawpularity-score

# ì••ì¶• í•´ì œ
!unzip -q -o petfinder-pawpularity-score.zip

# ë°ì´í„° ë¡œë“œ
import pandas as pd

train = pd.read_csv('train.csv')
test = pd.read_csv('test.csv')
sample_submission = pd.read_csv('sample_submission.csv')
```

### í•„ìš”í•œ ëª¨ë“ˆ ë¶ˆëŸ¬ì˜¤ê¸°
> timm, fastai

#### 1. `timm` (PyTorch Image Models)

> ìˆ˜ë§ì€ ìµœì‹  ì´ë¯¸ì§€ ë¶„ë¥˜ ëª¨ë¸ë“¤ì„ ë¹ ë¥´ê²Œ ë¶ˆëŸ¬ì˜¬ ìˆ˜ ìˆëŠ” PyTorch ê¸°ë°˜ ë¼ì´ë¸ŒëŸ¬ë¦¬

âœ… íŠ¹ì§•

* **ì‚¬ì „í•™ìŠµëœ(pretrained)** ëª¨ë¸ ìˆ˜ë°± ê°œ ë‚´ì¥ (ResNet, EfficientNet, Swin Transformer, ConvNeXt ë“±)
* `create_model()` í•œ ì¤„ë¡œ ë¶ˆëŸ¬ì˜¤ê¸° ê°€ëŠ¥
* ë‹¤ì–‘í•œ ëª¨ë¸ êµ¬ì¡°ì™€ head ì„¤ì •(ë¶„ë¥˜, íšŒê·€, feature extractor ë“±) ì§€ì›
* PyTorch ê¸°ë°˜ì´ë¼ **ìœ ì—°ì„±** ë†’ê³ , ì—°êµ¬ìš©/ì‹¤ì „ ëª¨ë‘ì— ì í•©
* ì´ë¯¸ì§€ ë¶„ë¥˜, **ì´ë¯¸ì§€ íšŒê·€**, Transfer learning, Fine-tuning ë“±ì— ì‚¬ìš©

#### 2. `fastai`
> ë”¥ëŸ¬ë‹ ì‹¤í—˜ì„ ë¹ ë¥´ê³  ì‰½ê²Œ í•  ìˆ˜ ìˆê²Œ ë§Œë“  ê³ ìˆ˜ì¤€ PyTorch wrapper ë¼ì´ë¸ŒëŸ¬ë¦¬

âœ… íŠ¹ì§•

* `DataBlock`, `Learner`, `cnn_learner` ê°™ì€ ê³ ìˆ˜ì¤€ API ì œê³µ
* **ìë™ í•™ìŠµë¥  íƒìƒ‰**, **ì „ì²˜ë¦¬/ì¦ê°•**, **ì½œë°±**, **ëª¨ë¸ í‰ê°€** ë“± ì‹¤ì „ ê¸°ëŠ¥ ë‹¤ìˆ˜ í¬í•¨
* tabular, vision, NLP, audio ë“± ë‹¤ì–‘í•œ ë„ë©”ì¸ ì§€ì›
* ëª¨ë¸ í•™ìŠµ ê³¼ì •ì„ ê°„ë‹¨íˆ êµ¬ì„±í•˜ê³  ë¹ ë¥´ê²Œ ë°˜ë³µ ì‹¤í—˜ ê°€ëŠ¥
* ì´ë¯¸ì§€ ë¶„ë¥˜/íšŒê·€, í…ìŠ¤íŠ¸ ë¶„ë¥˜, ê°ì„± ë¶„ì„, í‘œ ë°ì´í„° íšŒê·€/ë¶„ë¥˜, Rapid prototyping ë“±ì— ì‚¬ìš©

---

| ë¼ì´ë¸ŒëŸ¬ë¦¬    | ì£¼ìš” ê¸°ëŠ¥         | í™œìš© ëª©ì               |
| -------- | ------------- | ------------------ |
| `timm`   | ë‹¤ì–‘í•œ ì´ë¯¸ì§€ ëª¨ë¸ ì œê³µ | ëª¨ë¸ ì•„í‚¤í…ì²˜ ì„ íƒ         |
| `fastai` | í•™ìŠµ íŒŒì´í”„ë¼ì¸ êµ¬ì„±   | ë¹ ë¥¸ ì‹¤í—˜, ì „ì²´ ì›Œí¬í”Œë¡œìš° í†µí•© |



### ì´ë¯¸ì§€ ë°ì´í„° ë¡œë“œ
> fastai ë¼ì´ë¸ŒëŸ¬ë¦¬ì˜ `ImageDataLoaders.from_df()`ë¥¼ ì‚¬ìš©í•´ì„œ Pawpularity ëŒ€íšŒì˜ ë°ì´í„°ë¥¼ í•™ìŠµìš© DataLoaders ê°ì²´ë¡œ ë³€í™˜

```python
dls = ImageDataLoaders.from_df(train, #pass in train DataFrame
                               valid_pct=0.2, #80-20 train-validation random split
                               seed=999, #seed ê³ ì •
                               fn_col='path', #filename/path is in the second column of the DataFrame
                               label_col='norm_score', #label is in the first column of the DataFrame(target)
                               y_block=RegressionBlock, #The type of target(íšŒê·€ë¬¸ì œ)
                               bs=32, #pass in batch size(í•œ ë²ˆì— ëª¨ë¸ì— ë“¤ì–´ê°ˆ ìƒ˜í”Œ ìˆ˜)
                               num_workers=8, # ë°ì´í„° ë¡œë”© ì‹œ ë™ì‹œì— ì‘ì—…í•  í”„ë¡œì„¸ìŠ¤ ìˆ˜
                               item_tfms=Resize(224), #ê° ì´ë¯¸ì§€ë¥¼ 224Ã—224 í¬ê¸°ë¡œ ë¦¬ì‚¬ì´ì¦ˆ(ëª¨ë¸ ì…ë ¥ì— ë§ì¶”ê¸° ìœ„í•œ ì „ì²˜ë¦¬)
                               batch_tfms=setup_aug_tfms([Brightness(), Contrast(), Hue(), Saturation()])) #ë°°ì¹˜ ë‹¨ìœ„ ì¦ê°•

dls.show_batch() ## í•œ ë°°ì¹˜ë¥¼ ì‹œê°í™”í•´ì„œ í™•ì¸
```
![alt text](/kaggle_study/image/image42.png)

### ëª¨ë¸ í›ˆë ¨

```python
# define model
model = create_model('swin_large_patch4_window7_224', pretrained=True, num_classes=dls.c)

## `pretrained=True` â†’ ì‚¬ì „í•™ìŠµëœ ImageNet-1K ê°€ì¤‘ì¹˜ ì‚¬ìš©
## `num_classes=dls.c` â†’ fastaiì˜ DataLoaders(dls)ë¡œë¶€í„° íƒ€ê¹ƒ ì¶œë ¥ ìˆ˜ ìë™ ì„¤ì • (íšŒê·€ë©´ 1, ë¶„ë¥˜ë©´ í´ë˜ìŠ¤ ìˆ˜)
```

```python
# í‰ê°€ì§€í‘œ ì •ì˜
def petfinder_rmse(input, target):
    return 100 * torch.sqrt(F.mse_loss(F.sigmoid(input.flatten()), target))
```
ì˜ˆë¥¼ ë“¤ì–´, ëª¨ë¸ì´ `input = [2.3, 1.5]`ë¥¼ ì¶œë ¥í•˜ê³ ,
ì‹¤ì œ `target = [0.83, 0.65]` ë¼ë©´:

```python
sigmoid([2.3, 1.5]) â‰ˆ [0.908, 0.818]
# sigmoidëŠ” ë¡œì§“ê°’ì„ 0~1 ì‚¬ì´ë¡œ ì •ê·œí™”
â†’ MSE = ((0.908 - 0.83)^2 + (0.818 - 0.65)^2)/2 â‰ˆ 0.012
â†’ RMSE = sqrt(0.012) â‰ˆ 0.11
â†’ ë°˜í™˜ê°’ = 0.11 * 100 = 11
```
